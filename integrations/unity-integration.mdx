---
title: "Unity Integration - Plugin"
description: "Welcome to the NPC Builder Plugin for Unity!"
---

This guide will help you install the Unity plugin and integrate AI-driven NPCs into your Unity projects. We’ll cover setup, configuration of credentials, usage of the NPC Builder Unity component, and how to handle NPC interactions via C# scripts.

## Prerequisites

- **Unity** – Unity 2019.4 or higher (Unity 2020.2\+ recommended for Input System compatibility).
- **Development Platform** – Windows or Mac.
- **Basic Knowledge** – Familiarity with Unity’s editor and C# scripting.

## Installation

1. **Download the Plugin:** Get the _NPC Builder Unity Plugin_ package from the Unity Asset Store (if available) or the NPC Builder website. _(The plugin may still be in the publishing process on the Asset Store.)_
2. **Import into Unity:** In your Unity Editor, go to **Assets → Import Package → Custom Package**, and select the downloaded NPC Builder plugin `.unitypackage` file. Import all files when prompted.
3. **Enable/Verify Plugin:** After import, ensure the plugin is properly installed. You should see an **NPC Builder** menu or assets in your project. There’s no additional activation step – the plugin is ready to use once imported.

## Configuring Credentials

Before using NPC Builder in Unity, you need to provide your API credentials so the plugin can authenticate with the NPC Builder service. The plugin package includes a `config.json` file (located in the plugin’s folder under **Assets/**) for this purpose.

1. ****`Locate config.json:`**** In Unity’s Project panel, find the NPC Builder plugin folder and open the `config.json` file.
2. **Edit Credentials:** Replace the placeholder values with your actual credentials:

```
{
  "clientId": "YOUR_CLIENT_ID",
  "clientSecret": "YOUR_CLIENT_SECRET",
  "bearerToken": "YOUR_BEARER_TOKEN"
}
```

Use the **Client ID** and **Client Secret** from your NPC Builder account (found in the API Keys section of the developer dashboard) for permanent authentication. If you prefer a temporary approach, you can use a **Bearer token** (from the Quickstart) instead of or in addition to the client secret. The plugin will prioritize `clientSecret` over a token if both are provided.

## Using the Plugin in Unity

With the plugin installed and credentials set, you can now bring NPC interactions into your Unity scene:

1. **Add the Component:** Choose an existing GameObject (or create a new empty GameObject) to represent your NPC in the scene. In the Unity **Inspector**, click **Add Component** and add `NPCBuilderInteractions` to this object. This component handles all communication with NPC Builder.
2. **Configure NPC IDs:** In the `NPCBuilderInteractions` component’s fields, input the relevant IDs for your NPC. At minimum, specify the **Game ID**, **World ID**, and **Character Name** so the plugin knows which NPC context to use. _(You can retrieve these IDs from the NPC Builder web app – see the Quickstart guide for how to get them.)_
3. **Prepare for Interactions:** Optionally, set up events on the component (like Unity Events in the Inspector) to handle NPC responses or trigger in-game effects when the NPC speaks or performs an action. The plugin provides hooks like **OnMessageReceived** for this purpose.

### Example: Interacting with NPCs via Script

You can control NPC interactions through C# scripts. Below is an example MonoBehaviour script that starts a conversation with an NPC and listens for responses:

```c++
using System.Collections.Generic;
using NPCBuilder;                  // Namespace from the NPC Builder plugin
using UnityEngine;
using UnityEngine.InputSystem;
using static NPCBuilder.NPCBuilderInteractions; // For easier access to enum definitions

public class ApiInteractionsExample : MonoBehaviour
{
    // Reference to the NPCBuilderInteractions component on this GameObject
    private NPCBuilderInteractions npcBuilderInteractions;

    void Awake()
    {
        // Grab the NPCBuilderInteractions component attached to the same GameObject
        npcBuilderInteractions = GetComponent<NPCBuilderInteractions>();

        // Subscribe to the NPC's message-received event
        npcBuilderInteractions.OnMessageReceived += OnNPCMessageReceived;

        // Initiate an interaction by sending an initial user message to the NPC
        npcBuilderInteractions.StartInteraction(ConversationRole.User, "Hola Robot");
    }

    // This callback is invoked whenever a new message is received from the NPC.
    private void OnNPCMessageReceived(List<Message> conversation)
    {
        // Convert the entire conversation history to a single string (for logging or UI)
        string conversationString = npcBuilderInteractions.GetConversationString();
        Debug.Log(conversationString);

        // Loop through each message in the conversation history
        foreach (var message in conversation)
        {
            // If the message role is 'Assistant' (i.e., from the NPC), log its content
            if (message.role == ConversationRole.Assistant.ToRoleString())
            {
                Debug.Log("Assistant message: " + message.content);
            }
        }
    }

    void Update()
    {
        // Example input: if the V key is pressed, send another user message
        if (Keyboard.current.vKey.wasPressedThisFrame)
        {
            npcBuilderInteractions.StartInteraction(ConversationRole.User, "¿Qué quieres?");
        }
        // Example input: if the C key is pressed, clear the conversation history
        if (Keyboard.current.cKey.wasPressedThisFrame)
        {
            npcBuilderInteractions.ClearConversation();
        }
    }
}
```

In this script:

- On **Awake()**, we get the `NPCBuilderInteractions` component and subscribe to its **OnMessageReceived** event. We immediately start an interaction by sending a user message ("Hola Robot" – for example, “Hello Robot” in Spanish).
- The **OnNPCMessageReceived** handler logs the full conversation to Unity’s console and specifically logs any NPC (assistant) messages separately.
- In **Update()**, we demonstrate sending another message when the player presses **V**, and clearing the conversation (resetting NPC memory) when **C** is pressed. These are just examples – you can tie NPC interactions to any game events or UI inputs as needed.

After running this, each NPC response will be printed in the console. You could extend this to display dialogue in-game using Unity UI.

_(Above, the NPC’s reply will depend on its configured personality and the message; “Hola Robot” is just a sample initial message in Spanish.)_ When an NPC response is received, the plugin maintains the conversation context so future calls continue the dialogue thread automatically.

## Events in Unity (Advanced)

NPC Builder supports **Events**, which are game actions triggered by either the player or the NPC during conversations. For example, an NPC might trigger an event like _“give_item”_ when handing a player an item. The Unity plugin helps you handle these events easily.

### Event Types

NPC Builder distinguishes between two event categories:

- **Action Events:** An event with no item attached (e.g., an NPC performs an action like **follow_player** with no specific object).
- **Item Events:** An event associated with a specific item (e.g., **give_item** where an item like a “magic token” is involved).

Both types are configured on the NPC Builder platform and can be linked to game logic in Unity.

### Configuring Events on the NPC Builder Platform

Events and items can be defined globally or per character:

- **Global Events/Items:** Go to your NPC Builder **Settings** on the web platform. Under collections for Events or Items, add new entries that can be reused across all NPCs. For example, define a global event “trade” or item “GoldCoin” once, and link it to many NPCs.
- **Per-Character Events/Items:** In a character’s profile on the platform, you can directly add a new event or item specific to that NPC. You also have the option to **“Link from Repo”** to attach a globally defined event or item to this character.

### Event and Item Definitions

When creating events or items, you will provide:

- **Event:** A name (unique identifier), a description, and a type (Action or Item). If type is _Item_, it means this event will involve a particular item.
- **Item:** A name (unique ID), a description, and a category/type. For example, an item could be categorized as _Trade_(something exchangeable) or _Action_ (an object tied to an action) in your game logic.

These definitions are important so that when an event is triggered in dialogue, both you and the NPC understand what it represents (e.g., an event named “attack” might trigger combat in your game).

### Handling Events in Unity

The `NPCBuilderInteractions` component can help map events to in-game actions. One way to handle item events is to assign a Unity **GameObject** to represent the item in question, so that when an event triggers, you know which object to manipulate.

For example, the plugin provides a delegate you can subscribe to for retrieving associated GameObjects:

```
// Pseudo-code for linking an item GameObject when an event is triggered
npcBuilderInteractions.getGameObjectAssociatedToEvent += (GameObject obj) =>
{
    if (obj != null)
    {
        // 'obj' is the GameObject linked to the event's item, assign or use it as needed
        currentItemInContext = obj;
    }
};
```

In practice, you would set up the mapping of an NPC Builder event to a GameObject in the Unity Inspector (for example, linking the event name “lantern” to a Lantern prefab in the scene). Then, when that event occurs in dialogue, the plugin will pass the associated object to your code so you can handle it (like making the NPC pick up the lantern, etc.).

_(The exact implementation details depend on how the NPC Builder Unity SDK exposes event hooks. The above is a generalized example to illustrate the concept.)_

## Next Steps

You have successfully configured NPC Builder in Unity and even handled advanced event hooks. From here, you can create rich NPC interactions in your Unity game. Consider exploring the following:

- **Multiple NPCs:** Add the `NPCBuilderInteractions` component to multiple GameObjects to have several NPCs with distinct characters.
- **UI Integration:** Connect NPC dialogue to your game’s UI (e.g., showing NPC speech in a dialogue box).
- **Further Customization:** Tweak your NPC’s personality and scripts. For instance, adjust how the NPC decides to trigger events based on conversation content.

Finally, check out the **Tutorials** section for a full walkthrough of building a sample scene with NPC interactions, or move on to the **API Reference** to learn about server-side details of NPC Builder’s REST API.